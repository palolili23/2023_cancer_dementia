---
title: "Dissecting the causal question underlying the association between cancer and ADRD: an opportunity to understand sources of bias"
author: "L. Paloma Rojas-Saunero"
date: ""
output: [html_document]
editor_options: 
  chunk_output_type: console
bibliography: cancer_dementia.bib
---
```{r, echo =  FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(survival)
library(tidyverse)
library(tableone)
library(magrittr)
library(kableExtra)
# source(here::here("02_R", "03_descriptives.R"))
# source(here::here("02_R", "05_plots.R"))
# source(here::here("02_R", "05b_plot_causes_death.R"))
# table_results <- rio::import(here::here("02_R", "table_results.csv"))
# table_results_bounds <- rio::import(here::here("02_R", "table_results_bounds.csv"))
# models <- read_csv(here::here("04_reports", "models.csv")) %>% select(-6)
```


## 1. Introduction

Many observational studies have consistently found that individuals with cancer have a lower risk of developing of Alzheimer´s disease or related dementias (ADRD) when compared to individuals with no history of cancer [@ma2014;@hanson2016;@vanderwillik2018;@ospina2020] .  These findings have motivated substantial research toward mechanistic explanations, including searching for and hypothesizing that molecular and genetic mechanisms may explain this association[@behrens2009;@harris2014;@nudelman2019;@Papin2020;@driverbiogeront2014;@olson2019;@li2021;@driverpin12015]. These research inquiries inevitably lead to discussions of repurposing or augmenting current cancer chemotherapeutics for ADRD [@Snyder2017].

Nevertheless, inferring any treatment or mechanistic effects from the observed cancer-ADRD inverse association is not straightforward. Researchers have raised concerns related to the competing event of death, unmeasured confounding, and ascertainment error that could explain these results[@driverbiogeront2014;@ganguli2015]. However, understanding these or other sources of bias first requires making explicit the causal question. Moreover, making explicit the causal question is one step toward tying a research study to a question that is relevant to decision-making[@didelez2016;@labrecque2017].  

To illustrate the complexities of inferring hypothetical or available treatments’ effects on ADRD from the observed cancer-ADRD association, we focus on a specific question conceptualizing the  Pin1 enzyme as the target of intervention. Previous animal studies have shown that Pin1 enzyme over-expression promotes tumorigenesis, while its down-regulation is attributed to mechanisms that contribute to neurodegeneration and amyloid deposition[@driverpin12015;@angelucci2017;@li2021]. If we one day could develop a drug that increases Pin1 expression specifically in brain tissue in hopes of preventing dementia, we could pose the question as: _What is the effect of this Pin1-targeting drug on the risk of ADRD over time compared to standard treatments?_

To explore how we might learn about this effect using real-world data on cancer and ADRD, we progressively build a causal directed acyclic graph to connect this particular causal question to the observable data and the assumptions we rely on to study the effect. We exemplify different scenarios with data collected from the Rotterdam Study, a population-based cohort study. We describe the challenges and how they translate into the analytic decisions. Last, we discuss how information on mortality and cause of death can provides insight about the direction of some sources of bias.

## 2. Overview of the causal structure

If this hypothetical Pin1-targeting drug was developed, the best way to understand its effect on dementia risk would be to have a well-conducted randomized trial in which we randomize eligible participants in late midlife (e.g., ages 50-60 years) to receive this drug or not, and closely monitor ADRD over a lengthy follow-up. Since this drug is not currently available, at best we can use observational data on Pin1 expression measurements. For example, suppose that a biomarker test was available to measure Pin1 and we measured this biomarker from (stored) baseline blood samples in a population based-cohort that recruited participants in late midlife. Although this means we could measure the biomarker at a particular time in everyone, defined by the cohort study design, an unanswered question that would remain is related to the best time to measure the biomarker in an applied setting. This question is beyond the scope of this exercise and for didactic purpose we may consider that the study entrance (and subsequent data collection) date was part of a screening process.

In this observational study, confounding could explain the observed association between Pin1 and ADRD. In the directed acyclic graph [@whatif2020] of Figure 1, we present Pin1 expression as $P$ and ADRD diagnosis over time as $Y_{t+1}$. Both nodes may share causes $L$, and to assess the causal relationship between $P$ and $Y_{t+1}$ we would require adjusting for $L$. Previous studies have described age, sex, educational level and race/ethnicity as the minimal adjusting set of covariates[@ospina2020]. However, environmental and behavioral factors such as smoking, which are known to cause microenvironmental changes such as inflammation and changes in tissue remodeling, may translate into Pin1 over-expression and are also related to the development of ADRD[ref].

```{tikz, echo = FALSE, fig.cap = "Pin1 as biomarker and risk of dementia"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P$};
\node [above of = p, yshift = -0.8cm, xshift = -1cm](l) {$L$};
\node [gray!30, right of = p] (pstar) {$P^*_t$};
\node [gray!30, right of = pstar] (dp) {$D_t$};
\node [gray!30, right of = dp] (pstar2) {$P^*_{t+1}$};
\node [gray!30, right of = pstar2] (dp2) {$D_{t+1}$};
\node [right of = dp2] (y) {$Y_{t+1}$};
\node [gray!30, below of = dp2, yshift = 1cm](cd) {$C$};
\draw[->] (l) -- (p);
\draw[->, gray!30] (l) to (dp);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (dp2);
\draw[->] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, gray!30] (p) to (pstar);
\draw[->, gray!30] (pstar) -- (dp);
\draw[->, gray!30] (dp) -- (pstar2);
\draw[->, gray!30] (p) to [out=45,in=135, looseness=0.3] (pstar2);
\draw[->, gray!30] (dp) to [out=-45,in=-135, looseness=0.3] (dp2);
\draw[->, gray!30] (dp2) -- (y);
\draw[->, gray!30] (pstar2) -- (dp2);
\draw[->, gray!30] (cd) -- (dp);
\draw[->, gray!30] (cd) -- (dp2);
\draw[->, gray!30] (cd) -- (y);
\draw[->, gray!30, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\end{tikzpicture}
```

Currently, Pin1 expression is not an available biomarker for population-based research, so instead we may have to measure a proxy to approximate this exposure. Because Pin1 over-expression is present in tumors, and tumors are only measured through screening and diagnosis, previous studies have considered Pin1 over-expression as the explanation behind the inverse association between cancer and ADRD, though Pin1 was not explicitly part of the research question[@ospina2020;@driver2012;@musicco2013;@freedman2016;@bowles2017;@frain2017;@schmidt2017;@sun2020;@ording2020]. 

In a cohort setting, participants may have a cancer diagnosis at any point over follow-up. As such, we may consider cancer diagnosis as a time-varying process and to define cancer diagnosis as the proxy for Pin1 we may assume that Pin1 is over-expressed only by the time a person has the diagnosis, though this assumption may not represent the true biological process. We depict this feature in Figure 2, where $P^*_t$ and $P^*_{t+1}$ represent _cancer diagnosis_ over time, the measured proxy of $P$. Although we are measuring the association between cancer diagnosis over time and ADRD in the observed data, we are assuming that the captured effect is only through the pathway that involves $P$. 

```{tikz, echo = FALSE, fig.cap = "Cancer diagnosis as proxy for Pin1 expression"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P$};
\node [gray!30, above of = p, yshift = -0.8cm, xshift = -1cm](l) {$L$};
\node [right of = p] (pstar) {$P^*_t$};
\node [gray!30, right of = pstar] (dp) {$D_t$};
\node [right of = dp] (pstar2) {$P^*_{t+1}$};
\node [gray!30, right of = pstar2] (dp2) {$D_{t+1}$};
\node [right of = dp2] (y) {$Y_{t+1}$};
\node [gray!30, below of = dp2, yshift = 1cm](cd) {$C$};
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to (dp);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (dp2);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->] (p) to (pstar);
\draw[->, gray!30] (pstar) -- (dp);
\draw[->, gray!30] (dp) -- (pstar2);
\draw[->] (p) to [out=45,in=135, looseness=0.3] (pstar2);
\draw[->, gray!30] (dp) to [out=-45,in=-135, looseness=0.3] (dp2);
\draw[->, gray!30] (dp2) -- (y);
\draw[->, gray!30] (pstar2) -- (dp2);
\draw[->, gray!30] (cd) -- (dp);
\draw[->, gray!30] (cd) -- (dp2);
\draw[->, gray!30] (cd) -- (y);
\draw[->, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\end{tikzpicture}
```

Given the nature of an elderly cohort, cancer diagnosis will be measured in the subset of the population who survives other causes of death. In Figure 3 we represent death prior to cancer diagnosis as $D_t$, and the arrow between $D_t$ and $P^*_{t+1}$ represents a deterministic association such as that $P^*$ is only observed if $D_t$ is zero. The shared causes between $P$ and $D_t$ are also represented by $L$,  for simplicity we illustrate them with the same node, however, although some shared causes might affect $Y_{t+1}$ this representation would not restrict to those covariates only. 

We assume that there is no effect of Pin1 over-expression in all-cause mortality prior to cancer diagnosis (no arrow between $P$ and $D_t$), however dying prior to cancer diagnosis may represent a selection mechanism that prevents generalizability or transportability of the effect measure to the entire target population [@hernan2017]. 

Furthermore, we could consider unmeasured and differential measurement error due to other shared causes of cancer and ADRD including but not limited to: screening guidelines, type of health care coverage, health-seeking behaviors, and health care availability. 

```{tikz, echo = FALSE, fig.cap = "Death prior to cancer diagnosis"}

\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P$};
\node [above of = p, yshift = -0.8cm, xshift = -1cm](l) {$L$};
\node [right of = p] (pstar) {$P^*_t$};
\node [right of = pstar] (dp) {$D_t$};
\node [right of = dp] (pstar2) {$P^*_{t+1}$};
\node [gray!30, right of = pstar2] (dp2) {$D_{t+1}$};
\node [right of = dp2] (y) {$Y_{t+1}$};
\node [gray!30, below of = dp2, yshift = 1cm](cd) {$C$};
\draw[->] (l) -- (p);
\draw[->] (l) to (dp);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (dp2);
\draw[->] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->] (p) to (pstar);
\draw[->, gray!30] (pstar) -- (dp);
\draw[->] (dp) -- (pstar2);
\draw[->] (p) to [out=45,in=135, looseness=0.3] (pstar2);
\draw[->, gray!30] (dp) to [out=-45,in=-135, looseness=0.3] (dp2);
\draw[->, gray!30] (dp2) -- (y);
\draw[->, gray!30] (pstar2) -- (dp2);
\draw[->, gray!30] (cd) -- (dp);
\draw[->, gray!30] (cd) -- (dp2);
\draw[->, gray!30] (cd) -- (y);
\draw[->, gray!30, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\end{tikzpicture}
```

Even if survival prior to cancer diagnosis does not introduce bias over time, we can only measure ADRD over follow-up in the individuals who survive long enough to have an ADRD diagnosis, as represented in Figure 4. In this causal diagram we include one more node of death over time that comes after the exposure, represented as $D_{t+1}$, this acts as a competing event of $Y_{t+1}$ because if a participant dies prior to ADRD diagnosis, death prevents observing ADRD at future time-points. Furthermore, since $D_{t+1}$ and $Y_{t+1}$ are events related to aging and its consequences, $C$ represents the shared causes of both events such as cardiovascular conditions.

```{tikz, echo = FALSE, fig.cap = "Death as a competing event for dementia over follow-up"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P$};
\node [above of = p, yshift = -0.8cm, xshift = -1cm](l) {$L$};
\node [right of = p, gray!30] (pstar) {$P^*_t$};
\node [right of = pstar] (dp) {$D_t$};
\node [right of = dp, gray!30] (pstar2) {$P^*_{t+1}$};
\node [right of = pstar2] (dp2) {$D_{t+1}$};
\node [right of = dp2] (y) {$Y_{t+1}$};
\node [below of = dp2, yshift = 1cm](cd) {$C$};
\draw[->, gray!30] (pstar2) -- (dp2);
\draw[->, gray!30] (p) to (pstar);
\draw[->, gray!30] (pstar) -- (dp);
\draw[->, gray!30] (dp) -- (pstar2);
\draw[->, gray!30] (p) to [out=45,in=135, looseness=0.3] (pstar2);
\draw[->, gray!30, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\draw[->] (l) -- (p);
\draw[->] (l) to (dp);
\draw[->] (l) to [out=0,in=90, looseness=0.4] (dp2);
\draw[->] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->] (dp) to [out=-45,in=-135, looseness=0.3] (dp2);
\draw[->] (dp2) -- (y);
\draw[->] (cd) -- (dp);
\draw[->] (cd) -- (dp2);
\draw[->] (cd) -- (y);
\end{tikzpicture}
```

In the scenario where $P$ represented the targeted-drug for Pin1, and if this drug has no systemic beneficial or harmful side-effects such as that there is no arrow between $P$ and $D_{t+1}$, a total effect would quantify the effect of $P_0$ on $Y_{t+1}$ that does not include any pathway mediated through $D_{t+1}$[@young2020]. 

However, in the context of cancer diagnosis we cannot rule out it's effect on death, as observed in Figure 5. In this case a total effect of $P$ in $Y_{t+1}$ would include the causal pathway mediated by the effect of cancer diagnosis in mortality, which may translate into an inverse association[29]. To isolate the direct effect of $P$ in $Y_{t+1}$ through measurement of $P^*_t$ we have at least two alternatives. We can either imagine a causal question where we decompose the effect of cancer by the different mechanisms that affect dementia and death separately[@stensrud2020]. Alternatively, we can define an scenario where death could have been prevented. The latter is defined as the controlled direct effect, where death is considered as a censoring event and it relies on the assumption that we have measured all $C$ to block the pathway $Y_{t+1} \leftarrow C  \rightarrow D_{t+1} \rightarrow P^*_t \rightarrow P_0$. Previous studies have defined death as a censoring event [ref], although failed to explicitly define how to relax the independent censoring assumption and while adjusting for confounders for dementia may represent partially the adjustment for the competing event of death [@young2020], adjusting for baseline covariates may not be sufficient. Furthermore interpretation regarding the prevention of death was not explicitly portrait.


```{tikz, echo = FALSE, fig.cap = "Direct effect"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P$};
\node [gray!30, above of = p, yshift = -0.8cm, xshift = -1cm](l) {$L$};
\node [gray!30, right of = p] (pstar) {$P^*_t$};
\node [gray!30, right of = pstar] (dp) {$D_t$};
\node [gray!30, right of = dp] (pstar2) {$P^*_{t+1}$};
\node [gray!30, right of = pstar2] (dp2) {$D_{t+1}$};
\node [gray!30, right of = dp2] (y) {$Y_{t+1}$};
\node [gray!30, below of = dp2, yshift = 1cm](cd) {$C$};
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to (dp);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (dp2);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, gray!30] (p) to (pstar);
\draw[->, gray!30] (pstar) -- (dp);
\draw[->, gray!30] (dp) -- (pstar2);
\draw[->, gray!30] (p) to [out=45,in=135, looseness=0.3] (pstar2);
\draw[->, gray!30] (dp) to [out=-45,in=-135, looseness=0.3] (dp2);
\draw[->, gray!30] (dp2) -- (y);
\draw[->, gray!30] (pstar2) -- (dp2);
\draw[->, gray!30] (cd) -- (dp);
\draw[->, gray!30] (cd) -- (dp2);
\draw[->, gray!30] (cd) -- (y);
\draw[->, gray!30, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\end{tikzpicture}
```

Finally, if we combine the challenges related to cancer diagnosis as a proxy for Pin1 over-expression, and having death as a competing event of ADRD we observe the complexity of the causal diagram in Figure 5. This As mentioned above, this is nevertheless a simplified version since we omitted the time varying nature of all nodes in the graph, and thus are ignoring how feedback loops between them further complicate interpretability and identificability. We also ignore further measurement error on $P^*_t$ and $Y_{t+1}$. 

We now turn to an application where we show how these challenges, tied to different assumptions lead to different analytic decisions, and we will show ways to mitigate or better understand them given current available data.  Nevertheless, we acknowledge that given the large gap between $P_0$ and $P^*_t$, not only in terms of time between measurements and potential selection bias, but since cancer diagnosis represents a complex and heterogenous health condition that exceeds the representation of Pin1 expression, at best we may test the sharp null hypothesis rather than estimating the causal effect of Pin1.


```{tikz, echo = FALSE, fig.cap = "Direct effect"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P$};
\node [gray!30, above of = p, yshift = -0.8cm, xshift = -1cm](l) {$L$};
\node [gray!30, right of = p] (pstar) {$P^*_t$};
\node [gray!30, right of = pstar] (dp) {$D_t$};
\node [gray!30, right of = dp] (pstar2) {$P^*_{t+1}$};
\node [gray!30, right of = pstar2] (dp2) {$D_{t+1}$};
\node [gray!30, right of = dp2] (y) {$Y_{t+1}$};
\node [gray!30, below of = dp2, yshift = 1cm](cd) {$C$};
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to (dp);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (dp2);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, gray!30] (p) to (pstar);
\draw[->, gray!30] (pstar) -- (dp);
\draw[->, gray!30] (dp) -- (pstar2);
\draw[->, gray!30] (p) to [out=45,in=135, looseness=0.3] (pstar2);
\draw[->, gray!30] (dp) to [out=-45,in=-135, looseness=0.3] (dp2);
\draw[->, gray!30] (dp2) -- (y);
\draw[->, gray!30] (pstar2) -- (dp2);
\draw[->, gray!30] (cd) -- (dp);
\draw[->, gray!30] (cd) -- (dp2);
\draw[->, gray!30] (cd) -- (y);
\draw[->, gray!30, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\end{tikzpicture}
```
