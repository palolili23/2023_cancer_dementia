---
title: "Dissecting the causal question underlying the association between cancer and ADRD "
author: "L. Paloma Rojas-Saunero"
date: ""
output: [html_document]
bibliography: cancer_dementia.bib
---
```{r, echo =  FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.align="center")
```

### Motivation

Several observational studies have found that individuals with history or incident cancer that survive over follow-up have a lower risk of AlzheimerÂ´s disease or related dementias (ADRD) when compared to individuals with no history of cancer. Multiple mechanisms related to inflammatory response, immune response, etc etc are postulated to understand this phenomenon. However, the community has raised their concerned about the potential unmeasured confounding, selective survival and misclassification issues that could drive this results.

In the lasts few years there has been an important attention to unveiling the impact of death as a competing event, and the role of survival bias to explain this association. Previous studies alluded to choosing a particular summary measure or modeling approach to account for death (incidence rate ratios (ref), hazard ratios (ref), multistate models (ref)), though the underlying estimand remains unclear.

Overall, although observational studies have measured history of cancer and incident cancer as the key exposure, researchers refer to biological mechanisms which onset may be prior to cancer diagnosis and the effect of cancer treatment.

Pin1 is an enzime deeply involved in the pathogenesis of cancer and ADRD. One of the roles of Pin1 is regulate mitosis process and apoptosis. Over-expression of Pin1 has been found in several tumors and it's inhibition causes tumor regression. In contrast, since adult neuronal cells do not divide, Pin1 over-expression in brain tissue is used to restore tau and amyloid precursor protein to a functional shape, thus preventing the buildup of the toxic tau and beta-amyloid species associated with AD.

For this reason Pin1 regulation is proposed as one of the mechanisms that can explain the inverse association between cancer and AD found in observational studies.

Our aim is to outline one way to tie the etiological question of Pin1 with the questions that can be answered with observational data where Pin1 measurements are not available. We aim to draw the complexity of the research question by building progressively a directed acyclic graph (DAG) which help us connect the causal question to the observable data and the assumptions we rely on to identify the effect. We describe the challenges and illustrate the assumptions we have to fulfill to identify the effect.  


## Overview of the causal structure and assumptions related to cancer diagnosis as a proxy for Pin1

Given the previous literature on the topic, we focus the interest in answering the following question: _What is the direct effect of Pin1 over-expression at age of 65 in the risk of ADRD by age 85 compared to regulated expression of Pin1 by age of 65._ To identify this effect with real-world data, we will illustrate the causal question through a directed acyclic graphs (DAGs), spelling out the data generating mechanisms and assumptions tied to the data. 

The causal graph of Figure 1 illustrates a situation where Pin1, represented as $P$, was measured in all participants on their 65 birthday. Based on the measurement of Pin1, participant's exposure was classified as 1) Over-expressed Pin1 or 2) Regulated Pin1. Through out the follow-up each participant followed a strict monitoring for ADRD onset, represented as $Y_{85}$, and no participant was lost to follow-up nor died during the study period. 


was not an exposure or intervention randomized at age 65, therefore we have to consider a set of measured covariates $L$ for which conditional exchangeability holds. Previous studies have described age, sex, educational level and race/ethnicity as the minimal adjusting set of covariates (Ospina). However, environmental and behavioral factors such as smoking, alcohol intake, or chronic diseases which are known to cause microenvironmental changes such as inflammation and changes in tissue remodelling, may translate into Pin1 over-expression and are also related to the development of ADRD. Therefore, had we measured all $L$ we could identify the direct of $P$ in $Y_{85}$ by conditioning on $L$.

```{tikz, fig.ext = 'png', echo = FALSE, fig.cap = "Direct effect of Pin1 in ADRD"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P$};
\node [below of = p, yshift = 1cm, xshift = -1cm](l) {$L$};
\node [right of = p] (y) {$Y_{85}$};
\draw[->] (l) -- (p);
\draw[->, violet] (p) -- (y);
\draw[->] (l) -- (y);
\end{tikzpicture}
```

Unfortunately, Pin1 expression measurement is not available in real-world settings, thus we can only rely on a proxy of this exposure. Since Pin1 over-expression is present in tumors and tumors are only measured through screening and diagnosis, we considered cancer diagnosis as the proxy for Pin1 over-expression, as most observational studies have defined (all refs). We depict this feature in Figure 2, where $P^*$ represents _incident cancer diagnosis_, the measured proxy of $P$. In this DAG we colored the path $P^* \leftarrow P \rightarrow Y_{85}$ because although we are measuring the association between $P^*$ and $Y_85$ in the observed data, we are assuming that the effect is only through $P$.

```{tikz, fig.ext = 'png', echo = FALSE, fig.cap = "Direct effect of Pin1 in ADRD, with cancer diagnosis as proxy of Pin1"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P$};
\node [below of = p, yshift = 1cm, xshift = -1cm](l) {$L$};
\node [above of = p, yshift = -1cm](pstar) {$P^*$};
\node [right of = p] (y) {$Y_{85}$};
\draw[->, violet] (p) -- (pstar);
\draw[->, violet] (p) -- (y);
\draw[->] (l) -- (p);
\draw[->] (l) -- (y);

\end{tikzpicture}
```


A major challenge related to assigning cancer diagnosis as the proxy of Pin1 is defining time zero. Not everyone who had Pin1 over-expression will be diagnosed with cancer by age 65. For this reason prospective cohort studies have considered cancer as a time-varying or time-dependent exposure. This means that a participant who had cancer diagnosis at age 70 contributes to the "regulated Pin1" from age 65 to 70, and from age 70 and onwards to the "Over-expressed Pin1" arm. Alternatively, studies that have included participants with cancer diagnosis at the time of the diagnosis (for example from cancer registries such as SEER) and matched participants by age. If age at cancer diagnosis is considered as the time zero, we should be careful of adjusting for post-baseline covariates of $P$ or mediators between $P$ and $P^*$. 

Since the population is elderly, the risk of death at age 65 is not trivial and it increases over time. This means that some individuals may die prior to cancer diagnosis due to other leading causes of death at this age group, such as cardiovascular disease. As such, we can only measure $P^*$ in the subset of individuals who have survived long enough to have a cancer diagnosis. We zoom in the relationship of $P \rightarrow P^*$ in Figure 3. In this figure we include 
$D = 0$ between $P$ and $P^*$, this illustrates that to observe $P^*$, we condition (box around $D = )$ on surviving long enough to have a cancer diagnosis. 

Several risk factors that increase the risk of cancer might also be shared causes of death prior to cancer diagnosis, for example smoking may cause lung cancer and chronic obstructive pulmonary disease (a leading cause of death in this age group). Therefore, to isolate the effect of $P$ in $P^*$ (the violet arrow), we need to block all shared causes of Pin1 and death from other causes, and the shared causes of death from other causes and cancer diagnosis, both represented in Figure 3 as $C_1$ and $C_2$. In this way we assume a hypothetical scenario in which we could prevent death prior to cancer diagnosis, by conditioning on a rich set of covariates. This assumption must hold regardless of whether we use incident cancer as a time-varying exposure, or match cancer patients to participants free of cancer by age.

```{tikz, fig.ext = 'png', echo = FALSE, fig.cap = "Zoom in the association between P and P star"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P$};
\node [draw, right of = p] (d) {$D = 0$};
\node [right of = d] (pstar) {$P^*$};
\node [below of = p, yshift = 1cm, xshift = -1cm](l) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm](c) {$C_2$};
\draw[->] (p) -- (d);
\draw[->, violet] (p) to [out=45,in=135, looseness=0.4] (pstar);
\draw[->] (d) -- (pstar);
\draw[->] (l) -- (p);
\draw[->] (l) -- (d);
\draw[->] (c) -- (pstar);
\draw[->] (c) -- (d);
\end{tikzpicture}
```

Up to this point we have outlined the underlying assumptions of using incident cancer diagnosis as a proxy for Pin1 expression. We continue outlining the additional assumptions related to death as a competing event of ADRD. 

## Overview of the causal question and assumptions related to death as a competing event of ADRD

As illustrated in previous figures, we are interested in the direct effect of Pin1 in ADRD at 85 years, which means a length of follow-up of 20 years. However, mortality in elderly population between 65 and 85 is substancial, and a leading cause of death is cancer. This means that in order to measure ADRD by the age of 85, individuals have to had survive to cancer and to other causes. For this reason death is a competing event of ADRD because if a participant dies prior to ADRD diagnosis, death prevents from observing ADRD at future time-points. 

We can visualize this data feature in the causal diagram in Figure 4. In this DAG we include $D_{80}$ as a representation of Death by age 80, an arrow between $P$ and $D_{80}$ since $P$ may increase the mortality risk irrespective of cancer diagnosis. We also include an arrow between $P^*$ and $D_{80}$ since cancer diagnosis, and subsequent treatment (or lack of treatment) may have an effect on death. Last, the arrow from $D_{80}$ and $Y_{85}$ represents the key feature of a competing events data structure: an individual who dies by age 80 cannot subsequently develop ADRD, and since $D_{80}$ and $Y_{85}$ are events related to aging, $C$ represent the shared causes of both events.

In this DAG we observe that, had we measured and adjusted for $L$, we could estimate the total effect of $P$ in $Y_{85}$ without further assumptions. However the total effect is a causal estimand that includes both the direct pathway between $P$ and $Y_{85}$. This means that if Pin1 has an effect on mortality through cancer or other mechanisms, we will observe a protective effect of Pin1 overexpression in ADRD, partially mediated through death. 

If the aim is to isolate the direct effect of $P$ in $Y_{85}$ as in Figure 4 (violet arrows), we first need to define the causal estimand of interest. There are at least three causal estimands, each one has different interpretation and relies on different assumptions: the controlled direct effect, the survivor average causal effect and the separable direct effect. Through the next section we will discuss the controlled direct effect since this estimand is tied to frequently used estimators.

There are several ways to conceptualize direct effects and there are several causal parameters (estimands) to represent it, such as: the controlled direct effect (CDE), the survivor average causal effect and the separable direct effect. Through this section we will discuss the causal question, assumptions related to death and interpretation of the CDE since this estimand is connects to frequently used estimators.

THe CDE represents the effect of Pin1 in ADRD in a setting where we could have prevented death over the study period. 

```{tikz, fig.ext = 'png', echo = FALSE, fig.cap = "Effect of Pin1 in the risk of ADRD by age 85, with cancer diagnosis as proxy of Pin1"}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P$};
\node [below of = p, yshift = 1cm, xshift = -1cm](l) {$L$};
\node [above of = p, yshift = -1cm](pstar) {$P^*$};
\node [draw, right of = p] (d) {$D_{80}$};
\node [right of = d] (y) {$Y_{85}$};
\node [below of = d, yshift = 1cm, xshift = +1cm](c) {$C$};
\draw[->, violet] (p) -- (pstar);
\draw[->] (pstar) -- (d);
\draw[->] (p) -- (d);
\draw[->] (d) -- (y);
\draw[->] (l) -- (p);
\draw[->] (l) -- (y);
\draw[->] (c) -- (d);
\draw[->] (c) -- (y);
\draw[->, violet] (p) to [out=45,in=135, looseness=0.4] (y);
\end{tikzpicture}
```

## Example using the Rotterdam Study data

## Discussion

We need to figure out what the key aging-dependent changes are and how to modulate these factors safely

Causes such as aging, smoking, irradiation etc are causing micro environmental changes, like inflamation and changes in tissue remodelling. This promotes selection for adaptive mutations.

Efforts to prevent and treat cancer should converge with similar efforts to prevent other aging- associated diseases. 

We need better means to 

Youthful tissues

