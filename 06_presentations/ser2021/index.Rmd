---
title: "Toward a clearer understanding of the inverse association between cancer and dementia"
subtitle: ""  
author: 
  - "L. Paloma Rojas-Saunero"
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: xaringan-themer.css
    seal: false
    nature:
      highlightStyle: github
      highlightLines: true
      highlightLanguage: ["r", "css"]
      countIncrementalSlides: FALSE
      ratio: "16:9"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE, }
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(collapse = TRUE, fig.retina = 3, warning = FALSE,
                      message = FALSE, echo = FALSE, fig.showtext = TRUE, cache = TRUE)
library(WeightIt)
library(cobalt)
library(splines)
library(knitr)
library(kableExtra)

source(here::here("02_R", "04_direct_effect_simplified.R"))
source(here::here("02_R", "05_plots.R"))
source(here::here("02_R", "05b_plot_causes_death.R"))
table_results <- rio::import(here::here("02_R", "table_results.csv"))
table_results_bounds <- rio::import(here::here("02_R", "table_results_bounds.csv"))

```

```{r xaringan-themer, include=FALSE}
library(xaringanthemer)
style_mono_accent(
  base_color = "#011A5E",
  header_font_google = google_font("Fira Sans", "500"),
  table_row_even_background_color = "#FFFFFF",
  table_border_color = "#011A5E",
  text_font_google   = google_font("Lato", "400", "400i"),
  text_font_size = "30px"
)
```

background-image: url(./figs/ser.jpg), url(./figs/erasmus.png)
background-position: 5% 95%, 95% 5%
background-size: 25%, 15%
class: center, middle

## Towards a clearer understanding of the inverse association between cancer and dementia



<br> <br> <br>

.right[L. Paloma Rojas-Saunero, MD 

**Epidemiology department**]

---
## Introduction

<br><br>

- Observational studies have found an inverse association between cancer and the risk of AlzheimerÂ´s disease or related dementias (ADRD).

--

- To understand the potential sources of bias we first need to define the causal question.

--

- Refining the underlying question behind cancer diagnosis as the exposure unveils some of these concerns.

---

## Aims 

To conceptualize and progressively build a causal directed acyclic graph to connect this particular causal question to the observable data and the assumptions we rely on to identify the effect. 

---
### Pin1-targeting drug

<br><br>

.center[
```{tikz, fig.ext = 'png', echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$D$};
\node [right of = p] (y) {$Y_{t}$};
\draw[->] (p) -- (y);
\end{tikzpicture}
```

What is the effect of a Pin1 targeting drug $(D)$ in the risk of ADRD over time *t* $(Y_{t})$  compared to standard treatments?

]

???
In hypothetical setting, if Pin1-targeting drug was developed, the best way to understand its effect on dementia risk would be to do a randomized trial in which we randomize eligible participants in late midlife to receive this drug or not, and closely monitor ADRD over follow-up. 

---
### Pin1 expression as biomarker

<br><br>

.center[
```{tikz, fig.ext = 'png', echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P_0$};
\node [below of = p, yshift = 1cm, xshift = -1cm](l) {$L$};
\node [right of = p] (y) {$Y_{t}$};
\draw[->] (l) -- (p);
\draw[->, violet] (p) -- (y);
\draw[->] (l) -- (y);
\end{tikzpicture}
```

$P_0$ = Pin1 over-expression; $L$ = shared factors between $P$ and $Y_t$

]

???
We might be closer to developing biomarker for Pin1 expression in the future. So we can imagine a situation in which Pin1 exposure is measured in a population based cohort study, using stored blood samples.
Since this would be a observational setting, Pin1 expression and ADRD at time may share causes such as smoking, and that assessing the causal relationship requires adjusting for these confounders.

---
### Cancer diagnosis as the proxy of Pin1 biomarker

<br>

.center[
```{tikz, fig.ext = 'png', echo = FALSE, fig.cap = ""}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P_0$};
\node [below of = p, yshift = 1cm, xshift = -1cm](l) {$L$};
\node [above of = p, yshift = -1cm](pstar) {$P^*$};
\node [right of = p] (y) {$Y_{t}$};
\draw[->, violet] (p) -- (pstar);
\draw[->, violet] (p) -- (y);
\draw[->] (l) -- (p);
\draw[->] (l) -- (y);

\end{tikzpicture}
```

$P_0$ = Pin1 over-expression; $P^*$ = Cancer diagnosis; $L$ = shared factors between $P$ and $Y_t$ = ADRD diagnosis
]


???
At this moment this biomarker is not available, but we know that Pin1 over-expression stimulates tumor growth and for this reason we use cancer diagnosis as the proxy for Pin1.

---
### Zoom in the P and P* association

<br>

.center[
```{tikz, fig.ext = 'png', echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P_0$};
\node [right of = p] (d) {$D_{k} = 0$};
\node [right of = d] (pstar) {$P^*_{k+1}$};
\draw[->] (p) -- (d);
\draw[->, violet] (p) to [out=45,in=135, looseness=0.4] (pstar);
\draw[->] (d) -- (pstar);
\end{tikzpicture}
```

<br> <br> 

$P_0$ = Pin1 over-expression; $D_{k} = 0$ = surviving by time $k$; $P^*_{k+1}$ = Cancer diagnosis by time $k+1$ ; 

]

???


---
### Selection bias in the P and P* association

<br>

.center[
```{tikz, fig.ext = 'png', echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P_0$};
\node [right of = p] (d) {$D_{k} = 0$};
\node [right of = d] (pstar) {$P^*_{k+1}$};
\node [below of = p, yshift = 1cm, xshift = -1cm](l) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm](c) {$C_2$};
\draw[->] (p) -- (d);
\draw[->, violet] (p) to [out=45,in=135, looseness=0.4] (pstar);
\draw[->] (d) -- (pstar);
\draw[->] (l) -- (p);
\draw[->] (l) -- (d);
\draw[->] (c) -- (pstar);
\draw[->] (c) -- (d);
\end{tikzpicture}
```

<br> <br> 

$P_0$ = Pin1 over-expression; $D_{k} = 0$ = surviving by time $k$; $P^*_{k+1}$ = Cancer diagnosis by time $k+1$; $C_1$, $C_2$ shared factors such as smoking

]

???
In some way we need to assume that those who died would have the same risk of having a cancer diagnosis had they not died 
---
### Direct effect vs. total effect, potential bias

<br>

.center[
```{tikz, fig.ext = 'png', echo = FALSE, fig.cap = ""}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P$};
\node [above of = p, yshift = -1cm](pstar) {$P^*$};
\node [right of = p] (d) {$D_{t}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [below of = d, yshift = 1cm, xshift = +1cm](c) {$C$};
\draw[->, violet] (p) -- (pstar);
\draw[->] (p) -- (d);
\draw[->, very thick] (d) -- (y);
\draw[->] (c) -- (d);
\draw[->] (c) -- (y);
\draw[->, violet] (p) to [out=45,in=135, looseness=0.4] (y);
\end{tikzpicture}
```
]

???
In this setting death is treated as a censoring event and it can be interpreted as those who died would have the same risk of developing dementia if prevented from dying than those who remained alive and free of dementia at a given time point, conditional on shared causes of dementia and death

---
### All pieces together

.center[
```{tikz, fig.ext = 'png', echo = FALSE, fig.cap = ""}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm, auto,>=latex, scale = 0.5]
\node (p) {$P$};
\node [below of = p, yshift = 1cm, xshift = -1cm](l) {$L$};
\node [right of = p] (dp) {$D_t$};
\node [right of = dp] (pstar) {$P*_t$};
\node [right of = pstar] (d) {$D_{t+1}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [above of = dp, yshift = -1cm, xshift = +1cm](c) {$C_1$};
\node [above of = d, yshift = -1cm, xshift = +1cm](cd) {$C_2$};
\draw[->] (p) -- (dp);
\draw[->] (dp) -- (pstar);
\draw[->, violet] (p) to [out=-45,in=-135, looseness=0.3] (pstar);
\draw[->] (pstar) -- (d);
\draw[->] (p) to [out=-45,in=-135, looseness=0.3] (d);
\draw[->, violet] (p) to [out=-45,in=-135, looseness=0.3] (y);
\draw[->] (d) -- (y);
\draw[->] (l) -- (p);
\draw[->] (l) to [out=0,in=270, looseness=0.4] (y);
\draw[->] (c) -- (dp);
\draw[->] (c) -- (pstar);
\draw[->] (cd) -- (d);
\draw[->] (cd) -- (y);
\end{tikzpicture}
```

<br><br>

At best we can test the sharp null hypothesis
]


---
## Application to the Rotterdam Study

- Participants between 60 and 70 years old at study entry.

- Data on cancer diagnosis, dementia diagnosis and death was collected from national registries and electronical clinical records.


Three definitions of the proxy for Pin1 over-expression:

- _"Cancer ever vs. never"_  

- Cancer as a _"time-varying"_

- _"Time to cancer diagnosis"_

---

### Methods

- Inverse probability treatment weights to address confounding
  
  + *Age, sex, education, smoking status*

--

- Inverse probability censoring weights for death to relax the independent censoring assumption

  + *Age, sex, Apoe4, education and time-varying covariates: smoking, systolic blood pressure, BMI and incident cancer, heart disease, stroke and diabetes*

--

- We estimate the risk of dementia using a weighted Kaplan-Meier estimator. 

---

### Methods

Since the independent censoring assumption is untestable, we can consider extreme scenarios of independence and fit Peterson upper and lower bounds.

--

1) Total independence, that refers to an scenario were those who died would never develop dementia (lower bound).
  + Aalen-Johansen estimator treating death as a competing event.

--

2) Complete dependency, that refers to an scenario where those who died would have dementia prior to death (upper bound). 
  + The Kaplan Meier estimator for the combined outcome of dementia or death.

---
### Results

.pull-left[
```{r, echo = FALSE}
plot_distribution +
    theme_xaringan()
```
]

--

.pull-right[
- 24% had cancer, the median age of cancer diagnosis was 73 (IQR: 69-77). 

- Among participants with cancer, 6% had dementia and 63% (n = 549) died.

- Among participants free of cancer diagnosis, 14% had dementia and 23% died.
]
---
### Cancer as: never vs. ever

.pull-left[
```{r}
plot_1b
```

]

--

.pull-right[
```{r}
plot_1c
```

]

---

### Time to cancer

.pull-left[
```{r}
plot_3a
```

]

--

.pull-right[
```{r}
plot_3b
```

]
---
### Results

<br> 

.center[
```{r, echo = FALSE}
tb <- table_results %>%
  filter(model != "Unadjusted") %>% 
  select(-c(3, 4)) %>%
  rename(RD = rd, RR = rr, `HR (95%CI)` = hr)

tb %>% kbl() %>%
kable_styling(bootstrap_options = c("striped", "hover"))
```
]
---

### Extreme scenarios of independency between death and dementia

.pull-left[
```{r, echo = FALSE}
table_results_bounds %>% 
  select(-3, -4, - 6) %>%
    pivot_wider(names_from = c(model),
              values_from = rd) %>%
  ggplot(aes(
    y = Proxy,
    x = `IPTW + IPCW`,
    xmin = `Lower bound`,
    xmax = `Upper bound`
  )) +
  geom_vline(xintercept = 0,
             color = "#E69F00",
             size = 1.2) +
  geom_pointrange(shape = 15,
                  color = "#0072B2") +
  geom_errorbar(width = 0.2, color = "#0072B2") +
  labs(x = "Risk difference",
       y = NULL) + 
  theme_xaringan()
```
]

--

.pull-right[
```{r, echo = FALSE}
table_results_bounds %>% 
  select(-3, -4, - 5) %>%
    pivot_wider(names_from = c(model),
              values_from = rr) %>%
  ggplot(aes(
    y = Proxy,
    x = `IPTW + IPCW`,
    xmin = `Lower bound`,
    xmax = `Upper bound`
  )) +
  geom_vline(xintercept = 1,
             color = "#E69F00",
             size = 1.2) +
  geom_pointrange(shape = 15,
                  color = "#0072B2") +
  geom_errorbar(width = 0.2, color = "#0072B2") +
  labs(x = "Risk Ratio",
       y = NULL) + 
   scale_x_continuous(
    trans = "log10",
    # breaks = seq(0.7, 1.2, by = 0.1)
  ) +
  theme_xaringan()
```
]

---
### Conclusions

- The process of connecting our real question to the data help us identify the structure that will later represent the analytic decisions and assumptions.

--

- Cancer as the proxy for a molecular mechanism is tricky...
--

- When death is a competing event, prior to choosing the estimator we need to define what is the estimand of interest and be explicit about the assumptions and interpretations.

---

