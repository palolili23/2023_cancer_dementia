---
title: "Toward a clearer understanding of the inverse association between cancer and dementia"
subtitle: ""  
author: 
  - "L. Paloma Rojas-Saunero"
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: xaringan-themer.css
    seal: false
    nature:
      highlightStyle: github
      highlightLines: true
      highlightLanguage: ["r", "css"]
      countIncrementalSlides: FALSE
      ratio: "16:9"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE, fig.showtext = TRUE, cache = TRUE)

library(splines)
library(knitr)
library(kableExtra)

load(here::here("03_figs", "plots.RData"))
source(here::here("02_R", "05_plots.R"))
hr_results <- rio::import(here::here("02_R", "hr_results.csv"))
rd_results_ever <- rio::import(here::here("02_R", "rd_results_ever.csv"))
rd_results_tv <- rio::import(here::here("02_R", "rd_results_tv.csv"))
table_results_bounds <- rio::import(here::here("02_R", "table_results_bounds.csv")) %>% 
  select(1,2,rr) %>% 
  filter(Proxy != "Time to cancer",
         model != "IPTW + IPCW") %>% 
  pivot_wider(names_from = model, values_from = rr)

rr <- rd_results_ever %>%
  bind_rows(rd_results_tv) %>% 
  select(Proxy, model, rr, conf) %>% 
  pivot_wider(names_from = conf,
              values_from = rr) %>% 
  mutate(contrast = "Risk Ratio") %>% 
  rename(conf.high = conf.higher) %>% 
  mutate(Proxy = str_replace(Proxy, "Time-varing", "Time-varying"))

results <- hr_results %>% 
  mutate(contrast = "Hazard Ratio") %>%
  filter(Proxy != "Time to cancer") %>%
  mutate(Proxy = ifelse(
    Proxy == "Ever vs. Never", "Ever vs. never", "Time-varying")) %>% 
  bind_rows(rr) %>% 
  mutate(Proxy = str_to_sentence(Proxy))
```

```{r xaringan-themer, include=FALSE}
library(xaringanthemer)
style_mono_accent(
  base_color = "#011A5E",
  header_font_google = google_font("Fira Sans", "500"),
  table_row_even_background_color = "#FFFFFF",
  table_border_color = "#011A5E",
  text_font_google   = google_font("Lato", "400", "400i"),
  text_font_size = "30px"
)
```

background-image: url(./figs/ser.jpg), url(./figs/erasmus.png)
background-position: 5% 95%, 95% 5%
background-size: 25%, 15%
class: center, middle

## Towards a clearer understanding of the inverse association between cancer and dementia



<br> <br> <br>

.right[L. Paloma Rojas-Saunero, MD 

**Epidemiology department**]

---
### Introduction

<br><br>

- Observational studies have found an inverse association between cancer and dementia risk.

--

- Several genetic and molecular mechanisms have been proposed.

--

- Researchers have raised concerns related to measurement error, unmeasured confounding and selection bias.

---

### Introduction

```{tikz, echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P_0$};
\node [above of = p, yshift = -1cm, xshift = 1cm, gray!30](l) {$L$};
\node [right of = p, gray!30] (dp) {$D_t$};
\node [right of = dp, gray!30] (pstar) {$P^*_t$};
\node [right of = pstar, gray!30] (d) {$D_{t+1}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [below of = dp, yshift = 1cm, xshift = 1cm, gray!30](c) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm, gray!30](cd) {$C_2$};
\draw[->, gray!30] (p) -- (dp);
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\draw[->, gray!30] (dp) -- (pstar);
\draw[->, gray!30] (p) to [out=+45,in=+135, looseness=0.3] (pstar);
\draw[->, gray!30] (pstar) -- (d);
\draw[->, gray!30] (p) to [out=+45,in=+135, looseness=0.3] (d);
\draw[->, gray!30] (d) -- (y);
\draw[->, gray!30] (c) -- (dp);
\draw[->, gray!30] (c) -- (pstar);
\draw[->, gray!30] (cd) -- (d);
\draw[->, gray!30] (cd) -- (y);
\end{tikzpicture}
```

$P_0$ = Pin1 targeted-drug; $Y_{t+1}$ = Dementia diagnosis

---
### Pin1 expression as biomarker (Problem 1: _Confounding_)

```{tikz, echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P_0$};
\node [above of = p, yshift = -1cm, xshift = 1cm](l) {$L$};
\node [right of = p, gray!30] (dp) {$D_t$};
\node [right of = dp, gray!30] (pstar) {$P^*_t$};
\node [right of = pstar, gray!30] (d) {$D_{t+1}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [below of = dp, yshift = 1cm, xshift = 1cm, gray!30](c) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm, gray!30](cd) {$C_2$};
\draw[->, gray!30] (p) -- (dp);
\draw[->] (l) -- (p);
\draw[->] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, semithick] (p) to [out=45,in=135, looseness=0.3] (y);
\draw[->, gray!30] (dp) -- (pstar);
\draw[->, gray!30] (p) to [out=45,in=135, looseness=0.3] (pstar);
\draw[->, gray!30] (pstar) -- (d);
\draw[->, gray!30] (p) to [out=45,in=135, looseness=0.3] (d);
\draw[->, gray!30] (d) -- (y);
\draw[->, gray!30] (c) -- (dp);
\draw[->, gray!30] (c) -- (pstar);
\draw[->, gray!30] (cd) -- (d);
\draw[->, gray!30] (cd) -- (y);
\end{tikzpicture}
```

$P_0$ = Pin1 over-expression; $Y_{t+1}$ = Dementia diagnosis; $L$ = Shared causes of $P_0$ and $Y_{t+1}$


???
We might be closer to developing biomarker for Pin1 expression in the future. So we can imagine a situation in which Pin1 exposure is measured in a population based cohort study, using stored blood samples.
Since this would be a observational setting, Pin1 expression and ADRD at time may share causes such as smoking, and that assessing the causal relationship requires adjusting for these confounders.

---
### Cancer diagnosis as the proxy of Pin1 (Problem 2: _Time zero_)

```{tikz, echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P_0$};
\node [above of = p, yshift = -1cm, xshift = 1cm, gray!30](l) {$L$};
\node [right of = p, gray!30] (dp) {$D_t$};
\node [right of = dp] (pstar) {$P^*_t$};
\node [right of = pstar, gray!30] (d) {$D_{t+1}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [below of = dp, yshift = 1cm, xshift = 1cm, gray!30](c) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm, gray!30](cd) {$C_2$};
\draw[->, gray!30] (p) -- (dp);
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\draw[->, gray!30] (dp) -- (pstar);
\draw[->] (p) to [out=45,in=135, looseness=0.3] (pstar);
\draw[->, gray!30] (pstar) -- (d);
\draw[->, gray!30] (p) to [out=+45,in=+135, looseness=0.3] (d);
\draw[->, gray!30] (d) -- (y);
\draw[->, gray!30] (c) -- (dp);
\draw[->, gray!30] (c) -- (pstar);
\draw[->, gray!30] (cd) -- (d);
\draw[->, gray!30] (cd) -- (y);
\end{tikzpicture}
```


$P_0$ = Pin1 over-expression; $Y_{t+1}$ = Dementia diagnosis; $P^*_t$ = Cancer diagnosis

???
At this moment this biomarker is not available, but we know that Pin1 over-expression stimulates tumor growth and for this reason we use cancer diagnosis as the proxy for Pin1.

---
### Death prior to cancer diagnosis (Problem 3: _Survival bias_)

```{tikz, echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P_0$};
\node [above of = p, yshift = -1cm, xshift = 1cm, gray!30](l) {$L$};
\node [right of = p] (dp) {$D_t$};
\node [right of = dp] (pstar) {$P^*_t$};
\node [right of = pstar, gray!30] (d) {$D_{t+1}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [below of = dp, yshift = 1cm, xshift = 1cm, gray!30](c) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm, gray!30](cd) {$C_2$};
\draw[->] (p) -- (dp);
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\draw[->] (dp) -- (pstar);
\draw[->] (p) to [out=45,in=135, looseness=0.3] (pstar);
\draw[->, gray!30] (pstar) -- (d);
\draw[->, gray!30] (p) to [out=+45,in=+135, looseness=0.3] (d);
\draw[->, gray!30] (d) -- (y);
\draw[->, gray!30] (c) -- (dp);
\draw[->, gray!30] (c) -- (pstar);
\draw[->, gray!30] (cd) -- (d);
\draw[->, gray!30] (cd) -- (y);
\end{tikzpicture}
```

$P_0$ = Pin1 over-expression; $Y_{t+1}$ = Dementia diagnosis; $P^*_t$ = Cancer diagnosis; $D_t$ = Death prior to cancer diagnosis
???

---
### Death prior to cancer diagnosis (Problem 3: _Survival bias_)

```{tikz, echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P_0$};
\node [above of = p, yshift = -1cm, xshift = 1cm, gray!30](l) {$L$};
\node [right of = p] (dp) {$D_t$};
\node [right of = dp] (pstar) {$P^*_t$};
\node [right of = pstar, gray!30] (d) {$D_{t+1}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [below of = dp, yshift = 1cm, xshift = 1cm](c) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm, gray!30](cd) {$C_2$};
\draw[->] (p) -- (dp);
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\draw[->] (dp) -- (pstar);
\draw[->] (p) to [out=45,in=135, looseness=0.3] (pstar);
\draw[->, gray!30] (pstar) -- (d);
\draw[->, gray!30] (p) to [out=+45,in=+135, looseness=0.3] (d);
\draw[->, gray!30] (d) -- (y);
\draw[->] (c) -- (dp);
\draw[->] (c) -- (pstar);
\draw[->, gray!30] (cd) -- (d);
\draw[->, gray!30] (cd) -- (y);
\end{tikzpicture}
```

$P_0$ = Pin1 over-expression; $Y_{t+1}$ = Dementia diagnosis; $P^*_t$ = Cancer diagnosis; $D_t$ = Death prior to cancer diagnosis; $C_1$ = Shared causes of $D_t$ and $P^*$
???

---
### Death prior to dementia diagnosis (Problem 3: _Survival bias_)

```{tikz, echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P_0$};
\node [above of = p, yshift = -1cm, xshift = 1cm, gray!30](l) {$L$};
\node [right of = p, gray!30, gray!30] (dp) {$D_t$};
\node [right of = dp, gray!30] (pstar) {$P^*_t$};
\node [right of = pstar] (d) {$D_{t+1}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [below of = dp, yshift = 1cm, xshift = 1cm, gray!30](c) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm, gray!30](cd) {$C_2$};
\draw[->, gray!30] (p) -- (dp);
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\draw[->, gray!30] (dp) -- (pstar);
\draw[->, gray!30] (p) to [out=45,in=135, looseness=0.3] (pstar);
\draw[->, gray!30] (pstar) -- (d);
\draw[->] (p) to [out=+45,in=+135, looseness=0.3] (d);
\draw[->] (d) -- (y);
\draw[->, gray!30] (c) -- (dp);
\draw[->, gray!30] (c) -- (pstar);
\draw[->, gray!30] (cd) -- (d);
\draw[->, gray!30] (cd) -- (y);
\end{tikzpicture}
```

$P_0$ = Pin1 over-expression; $Y_{t+1}$ = Dementia diagnosis; $D_{t+1}$ = Death prior to dementia diagnosis

---
### Death prior to dementia diagnosis (Problem 3: _Survival bias_)


```{tikz, echo = FALSE}
\usetikzlibrary{arrows}
\begin{tikzpicture}[node distance=2cm]
\node (p) {$P_0$};
\node [above of = p, yshift = -1cm, xshift = 1cm, gray!30](l) {$L$};
\node [right of = p, gray!30, gray!30] (dp) {$D_t$};
\node [right of = dp, gray!30] (pstar) {$P^*_t$};
\node [right of = pstar] (d) {$D_{t+1}$};
\node [right of = d] (y) {$Y_{t+1}$};
\node [below of = dp, yshift = 1cm, xshift = 1cm, gray!30](c) {$C_1$};
\node [below of = d, yshift = 1cm, xshift = 1cm](cd) {$C_2$};
\draw[->, gray!30] (p) -- (dp);
\draw[->, gray!30] (l) -- (p);
\draw[->, gray!30] (l) to [out=0,in=90, looseness=0.4] (y);
\draw[->, semithick] (p) to [out=+45,in=+135, looseness=0.3] (y);
\draw[->, gray!30] (dp) -- (pstar);
\draw[->, gray!30] (p) to [out=45,in=135, looseness=0.3] (pstar);
\draw[->, gray!30] (pstar) -- (d);
\draw[->] (p) to [out=+45,in=+135, looseness=0.3] (d);
\draw[->] (d) -- (y);
\draw[->, gray!30] (c) -- (dp);
\draw[->, gray!30] (c) -- (pstar);
\draw[->] (cd) -- (d);
\draw[->] (cd) -- (y);
\end{tikzpicture}
```

$P_0$ = Pin1 over-expression; $Y_{t+1}$ = Dementia diagnosis; $D_{t+1}$ = Death prior to dementia diagnosis; $C_2$ as shared causes of $D_{t+1}$ and $Y_{t+1}$

---
## Application to the Rotterdam Study

- Participants between 60 and 70 years old at study entry, free of cancer and dementia diagnosis at baseline

--

- Data on cancer diagnosis, dementia diagnosis and death was collected from national registries and clinical records.

--

- Cancer:

  + _Time-fixed ever vs. never_
  
  + _Time-varying_

---
## Application to the Rotterdam Study


- Inverse probability treatment weights to address confounding (IPTW)
  
  + *Age, sex, Apoe4, education* 

--

- Inverse probability censoring weights for death (IPCW)

  + *Age, sex, Apoe4, education and time-varying covariates: smoking, systolic blood pressure, BMI and incident cancer, heart disease, stroke and diabetes*

--

- Risk of dementia and risk ratios are estimated with a weighted Kaplan-Meier estimator.

--

- Hazard ratios are estimated with a weighted Cox Proportional-Hazards Model for comparative purposes.

---
### Bounds 

<br><br>

- **1) Lower Bound**: Total independence, that refers to an scenario were those who died would never develop dementia (Death as competing event)

--

- **2) Upper Bound**: Complete dependency, that refers to an scenario where those who died would have dementia prior to death (Composite outcome, death + dementia)

---
### Results

.center[
```{r, echo = FALSE, fig.width= 14, fig.retina=3}
plot_distribution +
  theme(legend.position = "right",
        title = element_text(face = "bold", size = rel(1.5), color = "#011A5E"),
        axis.title.x = element_text(face = "bold", size = rel(1.5), color = "#011A5E")) +
  labs(title = "Proportion of participants in each status")
```
]

---

### Results

.pull-left[
```{r, echo = FALSE, fig.retina = 3}
temp <-
  table_results_bounds %>% slice(1) %>% mutate(model = "IPTW + IPCW", contrast = "Risk Ratio") %>% 
  rename(conf.low = `Lower bound`, conf.high = `Upper bound`)

results %>%
  filter(Proxy == "Ever vs. never") %>%
  mutate(model = fct_relevel(model, c("Unadjusted", "IPTW", "IPTW + IPCW"))) %>%
  ggplot(aes(
    y = contrast,
    x = point,
    xmin = conf.low,
    xmax = conf.high
  )) +
  geom_vline(xintercept = 1,
             color = "#E69F00",
             size = 1.2) +
  geom_pointrange(aes(shape = contrast), color = "#0072B2") +
  geom_errorbar(aes(group = contrast),
                width = 0.2,
                color = "#0072B2") +
  geom_point(
    data = temp,
    aes(x = conf.low),
    shape = 18,
    color = "#011A5E",
    size = 3
  ) +
  geom_point(
    data = temp,
    aes(x = conf.high),
    shape = 18,
    color = "#011A5E",
    size = 3
  ) +
  facet_grid(factor(model, levels = c("Unadjusted", "IPTW", "IPTW + IPCW")) ~
                 ., switch = "y") +
  # facet_grid(model ~., switch = "y", margins = FALSE) +
  scale_x_continuous(trans = "log10") +
  labs(
    x = NULL,
    y = NULL,
    group = NULL,
    shape = NULL,
    title = "Cancer as ever vs. never",
    subtitle = "Risk ratios \U25B2, Hazard ratios \U25CF, Bounds \U25C6" ) +
  theme(
    panel.spacing = unit(0, "lines"),
    panel.background = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank(),
    strip.text.y = element_text(
      face = "bold",
      size = rel(1.5),
      color = "#011A5E"
    ),
    axis.line.x = element_line(color = "#011A5E"),
    axis.text.x = element_text(size = rel(1.5), color = "#011A5E"),
    strip.background = element_blank(),
    plot.title = element_text(face = "bold", size = rel(2), color = "#011A5E"),
    plot.subtitle = element_text(face = "bold", size = rel(1.5), color = "#011A5E", hjust = 0.05),
    legend.position = "none")

```

]

--

.pull-right[
```{r, echo = FALSE, fig.retina = 3}
temp <-
  table_results_bounds %>% slice(2) %>% mutate(model = "IPTW + IPCW", contrast = "Risk Ratio") %>% 
  rename(conf.low = `Lower bound`, conf.high = `Upper bound`)

results %>%
  filter(Proxy == "Time-varying") %>%
  mutate(model = fct_relevel(model, c("Unadjusted", "IPTW", "IPTW + IPCW"))) %>%
  ggplot(aes(
    y = contrast,
    x = point,
    xmin = conf.low,
    xmax = conf.high
  )) +
  geom_vline(xintercept = 1,
             color = "#E69F00",
             size = 1.2) +
  geom_pointrange(aes(shape = contrast), color = "#0072B2") +
  geom_errorbar(aes(group = contrast),
                width = 0.2,
                color = "#0072B2") +
  geom_point(
    data = temp,
    aes(x = conf.low),
    shape = 18,
    color = "#011A5E",
    size = 3
  ) +
  geom_point(
    data = temp,
    aes(x = conf.high),
    shape = 18,
    color = "#011A5E",
    size = 3
  ) +
  facet_grid(factor(model, levels = c("Unadjusted", "IPTW", "IPTW + IPCW")) ~
                 ., switch = "y") +
  scale_x_continuous(trans = "log10") +
  labs(
    x = NULL,
    y = NULL,
    group = NULL,
    shape = NULL,
    title = "Time-varying cancer",
    subtitle = "Risk ratios \U25B2, Hazard ratios \U25CF, Bounds \U25C6" ) +
  theme(
    panel.spacing = unit(0, "lines"),
    panel.background = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank(),
    strip.text.y = element_text(
      face = "bold",
      size = rel(1.5),
      color = "#011A5E"
    ),
    axis.text.x = element_text(size = rel(1.5), color = "#011A5E"),
    axis.line.x = element_line(color = "#011A5E"),
    strip.background = element_blank(),
    plot.title = element_text(face = "bold", size = rel(2), color = "#011A5E"),
    plot.subtitle = element_text(face = "bold", size = rel(1.5), color = "#011A5E", hjust = 0.05),
    legend.position = "none")
```

]


---
### Conclusions

- The process of connecting our real question to the data help us identify the structure that will later represent the analytic decisions and assumptions.

--

- Cancer as the proxy for a molecular mechanism is tricky...
--

- When death is a competing event, prior to choosing the estimator we need to define what is the estimand of interest and be explicit about the assumptions and interpretations.

---

